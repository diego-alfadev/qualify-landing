---
import {
  LuMessageCircle,
  LuGlobe,
  LuCpu,
  LuCheck,
  LuPhone,
  LuMail,
  LuBuilding,
} from "react-icons/lu";
---

<div class="w-full relative mb-20 hidden sm:block">
  <div class="text-center max-w-3xl mx-auto mb-20">
    <h2 class="h2 mb-6">
      No te preocupes por la <span
        class="bg-clip-text text-transparent bg-gradient-to-r from-primary to-accent"
        >cualificación</span
      >
    </h2>
    <p class="text-text-secondary text-lg leading-relaxed">
      Simplifica tu proceso de venta con Qualify, la solución de clasificación
      de leads que te ayuda a obtener mejores resultados en menos tiempo.
    </p>
  </div>

  <div
    class="relative w-full aspect-[2.5/1] min-h-[320px] glass-panel rounded-3xl border border-white/5 overflow-hidden"
  >
    {/* Background Grid */}
    <div
      class="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.02)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.02)_1px,transparent_1px)] bg-[size:30px_30px]"
    >
    </div>

    {/* SVG Layer */}
    <svg
      class="absolute inset-0 w-full h-full pointer-events-none z-0"
      viewBox="0 0 800 320"
      preserveAspectRatio="xMidYMid meet"
    >
      <defs>
        <linearGradient
          id="lineGradFunnel"
          x1="0"
          y1="0"
          x2="1"
          y2="0"
          gradientUnits="userSpaceOnUse"
        >
          <stop offset="0%" stop-color="rgba(16, 185, 129, 0.1)"></stop>
          <stop offset="50%" stop-color="rgba(16, 185, 129, 0.4)"></stop>
          <stop offset="100%" stop-color="rgba(16, 185, 129, 0.1)"></stop>
        </linearGradient>
        <filter id="glowFunnel">
          <feGaussianBlur stdDeviation="3" result="coloredBlur"
          ></feGaussianBlur>
          <feMerge>
            <feMergeNode in="coloredBlur"></feMergeNode>
            <feMergeNode in="SourceGraphic"></feMergeNode>
          </feMerge>
        </filter>
      </defs>

      {/* Connections: Sources to Engine (400, 160) */}
      {/* Top: Portals (180, 80) */}
      <path
        d="M 180 80 Q 290 80 400 160"
        fill="none"
        stroke="url(#lineGradFunnel)"
        stroke-width="1.5"
        opacity="0.5"></path>
      {/* Middle: Contact (180, 160) */}
      <path
        d="M 180 160 L 400 160"
        fill="none"
        stroke="url(#lineGradFunnel)"
        stroke-width="1.5"
        opacity="0.5"></path>
      {/* Bottom: Web (180, 240) */}
      <path
        d="M 180 240 Q 290 240 400 160"
        fill="none"
        stroke="url(#lineGradFunnel)"
        stroke-width="1.5"
        opacity="0.5"></path>

      {/* Connection: Engine to Output (620, 160) */}
      <path
        d="M 400 160 L 620 160"
        fill="none"
        stroke="url(#lineGradFunnel)"
        stroke-width="2"
        opacity="0.6"></path>

      {/* Travelling Particles */}
      <circle r="3" fill="#10b981" filter="url(#glowFunnel)">
        <animateMotion
          dur="3s"
          repeatCount="indefinite"
          path="M 180 80 Q 290 80 400 160"></animateMotion>
        <animate
          attributeName="opacity"
          values="0;1;0"
          dur="3s"
          repeatCount="indefinite"></animate>
      </circle>
      <circle r="3" fill="#10b981" filter="url(#glowFunnel)">
        <animateMotion
          dur="2.5s"
          repeatCount="indefinite"
          path="M 180 160 L 400 160"></animateMotion>
        <animate
          attributeName="opacity"
          values="0;1;0"
          dur="2.5s"
          repeatCount="indefinite"></animate>
      </circle>
      <circle r="3" fill="#10b981" filter="url(#glowFunnel)">
        <animateMotion
          dur="4s"
          repeatCount="indefinite"
          path="M 180 240 Q 290 240 400 160"></animateMotion>
        <animate
          attributeName="opacity"
          values="0;1;0"
          dur="4s"
          repeatCount="indefinite"></animate>
      </circle>

      {/* Output Particle */}
      <circle r="4" fill="#6ee7b7" filter="url(#glowFunnel)" opacity="0">
        <animateMotion
          dur="3s"
          begin="1s"
          repeatCount="indefinite"
          path="M 400 160 L 620 160"></animateMotion>
        <animate
          attributeName="opacity"
          values="0;1;0"
          dur="3s"
          begin="1s"
          repeatCount="indefinite"></animate>
      </circle>
    </svg>

    {/* DOM Overlays - Compact & Static */}

    {/* --- NODE 1: PORTALES (Left=180 -> 22.5%. Top=80 -> 25%) --- */}
    <div
      class="absolute top-[25%] left-[22.5%] -translate-x-1/2 -translate-y-1/2 z-10"
    >
      <div class="relative group">
        <div
          class="flex items-center gap-2 px-3 py-1.5 bg-black/80 border border-white/10 rounded-full shadow-lg z-20 relative"
        >
          <LuBuilding className="text-blue-400 w-3.5 h-3.5" />
          <span class="text-xs font-semibold text-gray-200">Portales</span>
        </div>
        {/* Floating Examples */}
        <div
          class="absolute -top-6 -right-8 px-2 py-0.5 bg-blue-900/20 border border-blue-500/20 rounded text-[10px] text-blue-300 animate-float"
        >
          Idealista
        </div>
        <div
          class="absolute -bottom-6 -right-4 px-2 py-0.5 bg-blue-900/20 border border-blue-500/20 rounded text-[10px] text-blue-300 animate-float delay-100"
        >
          Fotocasa
        </div>
      </div>
    </div>

    {/* --- NODE 2: CONTACTO DIRECTO (Left=180 -> 22.5%. Top=160 -> 50%) --- */}
    <div
      class="absolute top-[50%] left-[22.5%] -translate-x-1/2 -translate-y-1/2 z-10"
    >
      <div class="relative group">
        <div
          class="flex items-center gap-2 px-3 py-1.5 bg-black/80 border border-white/10 rounded-full shadow-lg z-20 relative"
        >
          <LuMessageCircle className="text-green-400 w-3.5 h-3.5" />
          <span class="text-xs font-semibold text-gray-200"
            >Contacto Directo</span
          >
        </div>
        {/* Floating Examples */}
        <div
          class="absolute -top-5 -right-6 p-1 bg-green-900/20 border border-green-500/20 rounded-full animate-float delay-75"
        >
          <LuPhone className="w-3 h-3 text-green-400" />
        </div>
        <div
          class="absolute -bottom-5 -right-6 p-1 bg-green-900/20 border border-green-500/20 rounded-full animate-float delay-150"
        >
          <LuMail className="w-3 h-3 text-green-400" />
        </div>
      </div>
    </div>

    {/* --- NODE 3: CANALES PROPIOS (Left=180 -> 22.5%. Top=240 -> 75%) --- */}
    <div
      class="absolute top-[75%] left-[22.5%] -translate-x-1/2 -translate-y-1/2 z-10"
    >
      <div class="relative group">
        <div
          class="flex items-center gap-2 px-3 py-1.5 bg-black/80 border border-white/10 rounded-full shadow-lg z-20 relative"
        >
          <LuGlobe className="text-purple-400 w-3.5 h-3.5" />
          <span class="text-xs font-semibold text-gray-200"
            >Canales Propios</span
          >
        </div>
        {/* Floating Examples */}
        <div
          class="absolute -top-6 -right-6 px-2 py-0.5 bg-purple-900/20 border border-purple-500/20 rounded text-[10px] text-purple-300 animate-float"
        >
          Web / Ads
        </div>
      </div>
    </div>

    {/* --- ENGINE (Left=400 -> 50%. Top=160 -> 50%) --- */}
    <div
      class="absolute top-[50%] left-[50%] -translate-x-1/2 -translate-y-1/2 z-20 flex flex-col items-center"
    >
      <div
        class="w-16 h-16 bg-black border border-emerald-500/50 rounded-full flex items-center justify-center shadow-[0_0_40px_rgba(16,185,129,0.3)] relative z-10"
      >
        <LuCpu className="text-emerald-400 w-7 h-7" />
        <div
          class="absolute -bottom-6 left-1/2 -translate-x-1/2 whitespace-nowrap"
        >
          <div
            class="px-1.5 py-0.5 bg-black/60 border border-emerald-500/20 rounded text-[9px] text-emerald-500 font-mono"
          >
            Q-ENGINE
          </div>
        </div>
      </div>
    </div>

    {/* --- OUTPUT (Left=620 -> 77.5%. Top=160 -> 50%) --- */}
    <div
      class="absolute top-[50%] left-[77.5%] -translate-y-1/2 -translate-x-[15%] z-10"
    >
      <div
        class="flex items-center gap-3 p-3 pr-5 bg-emerald-950/30 border border-emerald-400/30 rounded-xl backdrop-blur-md shadow-lg"
      >
        <div
          class="w-10 h-10 rounded-lg bg-emerald-500 flex items-center justify-center text-white shadow-lg"
        >
          <LuCheck size={20} strokeWidth={3} />
        </div>
        <div>
          <span class="block text-sm font-bold text-white tracking-wide"
            >Lead Cualificado</span
          >
          <span class="block text-[10px] text-emerald-400/90 font-medium"
            >Listo para cerrar</span
          >
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .animate-float {
    animation: float 4s ease-in-out infinite;
  }
  .delay-75 {
    animation-delay: 0.75s;
  }
  .delay-100 {
    animation-delay: 1s;
  }
  .delay-150 {
    animation-delay: 1.5s;
  }
  @keyframes float {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-5px);
    }
  }
</style>
